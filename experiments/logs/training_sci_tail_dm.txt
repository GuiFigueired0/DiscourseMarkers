Loading dataset: allenai/scitail
Train size: 23097
Val size:   1304
Test size:  2126
Encoding dataset labels to ClassLabel...
Labels found: ['entails', 'neutral']
Tokenizing datasets...
Map:   0%|          | 0/23097 [00:00<?, ? examples/s]Map:   9%|‚ñä         | 2000/23097 [00:00<00:01, 13348.52 examples/s]Map:  26%|‚ñà‚ñà‚ñå       | 6000/23097 [00:00<00:00, 21250.17 examples/s]Map:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 10000/23097 [00:00<00:00, 22505.55 examples/s]Map:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 14000/23097 [00:00<00:00, 24307.14 examples/s]Map:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 18000/23097 [00:00<00:00, 24953.13 examples/s]Map:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 22000/23097 [00:00<00:00, 25569.22 examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 23097/23097 [00:00<00:00, 23703.84 examples/s]
Map:   0%|          | 0/2126 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2126/2126 [00:00<00:00, 26214.86 examples/s]
Map:   0%|          | 0/1304 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1304/1304 [00:00<00:00, 21812.92 examples/s]
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at models/roberta-dm-4class-final and are newly initialized because the shapes did not match:
- classifier.out_proj.bias: found shape torch.Size([4]) in the checkpoint and torch.Size([2]) in the model instantiated
- classifier.out_proj.weight: found shape torch.Size([4, 768]) in the checkpoint and torch.Size([2, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Initializing Model...
Starting Training (Baseline)...
  0%|          | 0/7220 [00:00<?, ?it/s]  0%|          | 1/7220 [00:00<49:26,  2.43it/s]  0%|          | 3/7220 [00:00<20:48,  5.78it/s]  0%|          | 5/7220 [00:00<15:47,  7.62it/s]  0%|          | 7/7220 [00:00<13:54,  8.64it/s]  0%|          | 9/7220 [00:01<13:25,  8.95it/s]  0%|          | 10/7220 [00:01<13:12,  9.10it/s]  0%|          | 12/7220 [00:01<11:56, 10.06it/s]  0%|          | 14/7220 [00:01<11:27, 10.48it/s]  0%|          | 16/7220 [00:01<11:26, 10.49it/s]  0%|          | 18/7220 [00:01<11:20, 10.58it/s]  0%|          | 20/7220 [00:02<11:49, 10.14it/s]  0%|          | 22/7220 [00:02<11:40, 10.28it/s]  0%|          | 24/7220 [00:02<11:45, 10.20it/s]  0%|          | 26/7220 [00:02<11:30, 10.42it/s]  0%|          | 28/7220 [00:02<11:31, 10.40it/s]  0%|          | 30/7220 [00:03<11:38, 10.30it/s]  0%|          | 32/7220 [00:03<11:05, 10.80it/s]  0%|          | 34/7220 [00:03<11:18, 10.59it/s]  0%|          | 36/7220 [00:03<11:38, 10.28it/s]  1%|          | 38/7220 [00:03<11:54, 10.05it/s]  1%|          | 40/7220 [00:04<12:25,  9.64it/s]  1%|          | 41/7220 [00:04<12:26,  9.61it/s]  1%|          | 43/7220 [00:04<12:02,  9.93it/s]  1%|          | 45/7220 [00:04<11:51, 10.09it/s]  1%|          | 47/7220 [00:04<11:23, 10.49it/s]  1%|          | 49/7220 [00:05<11:43, 10.19it/s]  1%|          | 51/7220 [00:05<11:28, 10.41it/s]  1%|          | 53/7220 [00:05<11:47, 10.13it/s]  1%|          | 55/7220 [00:05<11:41, 10.22it/s]  1%|          | 57/7220 [00:05<11:28, 10.41it/s]  1%|          | 59/7220 [00:06<11:33, 10.32it/s]  1%|          | 61/7220 [00:06<11:07, 10.72it/s]  1%|          | 63/7220 [00:06<11:08, 10.71it/s]  1%|          | 65/7220 [00:06<10:48, 11.03it/s]  1%|          | 67/7220 [00:06<11:05, 10.75it/s]  1%|          | 69/7220 [00:06<11:28, 10.39it/s]  1%|          | 71/7220 [00:07<11:21, 10.49it/s]  1%|          | 73/7220 [00:07<11:35, 10.27it/s]  1%|          | 75/7220 [00:07<11:47, 10.10it/s]  1%|          | 77/7220 [00:07<11:47, 10.09it/s]  1%|          | 79/7220 [00:07<11:47, 10.09it/s]  1%|          | 81/7220 [00:08<11:36, 10.24it/s]  1%|          | 83/7220 [00:08<11:30, 10.33it/s]  1%|          | 85/7220 [00:08<11:12, 10.61it/s]  1%|          | 87/7220 [00:08<11:26, 10.40it/s]  1%|          | 89/7220 [00:08<12:09,  9.78it/s]  1%|          | 90/7220 [00:09<12:27,  9.54it/s]  1%|‚ñè         | 91/7220 [00:09<22:02,  5.39it/s]  1%|‚ñè         | 93/7220 [00:09<18:00,  6.59it/s]  1%|‚ñè         | 95/7220 [00:09<15:51,  7.49it/s]  1%|‚ñè         | 97/7220 [00:10<14:02,  8.46it/s]  1%|‚ñè         | 98/7220 [00:10<13:41,  8.67it/s]  1%|‚ñè         | 100/7220 [00:10<12:51,  9.23it/s]  1%|‚ñè         | 102/7220 [00:10<11:44, 10.11it/s]  1%|‚ñè         | 104/7220 [00:10<11:17, 10.50it/s]  1%|‚ñè         | 106/7220 [00:10<11:05, 10.69it/s]  1%|‚ñè         | 108/7220 [00:11<11:25, 10.37it/s]  2%|‚ñè         | 110/7220 [00:11<11:30, 10.30it/s]  2%|‚ñè         | 112/7220 [00:11<11:21, 10.43it/s]  2%|‚ñè         | 114/7220 [00:11<11:28, 10.32it/s]  2%|‚ñè         | 116/7220 [00:11<11:18, 10.48it/s]  2%|‚ñè         | 118/7220 [00:12<11:10, 10.59it/s]  2%|‚ñè         | 120/7220 [00:12<11:33, 10.24it/s]  2%|‚ñè         | 122/7220 [00:12<11:21, 10.41it/s]  2%|‚ñè         | 124/7220 [00:12<11:23, 10.38it/s]  2%|‚ñè         | 126/7220 [00:12<11:00, 10.74it/s]  2%|‚ñè         | 128/7220 [00:13<10:50, 10.91it/s]  2%|‚ñè         | 130/7220 [00:13<10:45, 10.99it/s]  2%|‚ñè         | 132/7220 [00:13<11:08, 10.60it/s]  2%|‚ñè         | 134/7220 [00:13<11:11, 10.56it/s]  2%|‚ñè         | 136/7220 [00:13<10:59, 10.74it/s]  2%|‚ñè         | 138/7220 [00:13<11:05, 10.64it/s]  2%|‚ñè         | 140/7220 [00:14<10:56, 10.79it/s]  2%|‚ñè         | 142/7220 [00:14<11:30, 10.25it/s]  2%|‚ñè         | 144/7220 [00:14<11:50,  9.96it/s]  2%|‚ñè         | 146/7220 [00:14<11:22, 10.36it/s]  2%|‚ñè         | 148/7220 [00:14<11:15, 10.48it/s]  2%|‚ñè         | 150/7220 [00:15<11:04, 10.63it/s]  2%|‚ñè         | 152/7220 [00:15<11:18, 10.41it/s]  2%|‚ñè         | 154/7220 [00:15<11:21, 10.36it/s]  2%|‚ñè         | 156/7220 [00:16<18:36,  6.33it/s]  2%|‚ñè         | 157/7220 [00:16<17:44,  6.64it/s]  2%|‚ñè         | 159/7220 [00:16<15:45,  7.47it/s]  2%|‚ñè         | 160/7220 [00:16<15:00,  7.84it/s]  2%|‚ñè         | 161/7220 [00:16<14:23,  8.18it/s]  2%|‚ñè         | 162/7220 [00:16<13:47,  8.53it/s]  2%|‚ñè         | 163/7220 [00:16<13:27,  8.74it/s]  2%|‚ñè         | 165/7220 [00:17<12:26,  9.45it/s]  2%|‚ñè         | 167/7220 [00:17<12:00,  9.79it/s]  2%|‚ñè         | 169/7220 [00:17<11:55,  9.86it/s]  2%|‚ñè         | 171/7220 [00:17<11:29, 10.23it/s]  2%|‚ñè         | 173/7220 [00:17<11:15, 10.43it/s]  2%|‚ñè         | 175/7220 [00:17<11:04, 10.60it/s]  2%|‚ñè         | 177/7220 [00:18<11:05, 10.58it/s]  2%|‚ñè         | 179/7220 [00:18<10:32, 11.14it/s]  3%|‚ñé         | 181/7220 [00:18<10:55, 10.73it/s]  3%|‚ñé         | 183/7220 [00:18<11:17, 10.38it/s]  3%|‚ñé         | 185/7220 [00:18<11:17, 10.38it/s]  3%|‚ñé         | 187/7220 [00:19<10:54, 10.75it/s]  3%|‚ñé         | 189/7220 [00:19<10:49, 10.83it/s]  3%|‚ñé         | 191/7220 [00:19<10:58, 10.68it/s]  3%|‚ñé         | 193/7220 [00:19<10:37, 11.03it/s]  3%|‚ñé         | 195/7220 [00:19<10:30, 11.14it/s]  3%|‚ñé         | 197/7220 [00:19<10:47, 10.84it/s]  3%|‚ñé         | 199/7220 [00:20<11:27, 10.22it/s]  3%|‚ñé         | 201/7220 [00:20<10:51, 10.77it/s]  3%|‚ñé         | 203/7220 [00:20<10:55, 10.71it/s]  3%|‚ñé         | 205/7220 [00:20<10:57, 10.68it/s]  3%|‚ñé         | 207/7220 [00:20<10:59, 10.64it/s]  3%|‚ñé         | 209/7220 [00:21<11:04, 10.55it/s]  3%|‚ñé         | 211/7220 [00:21<10:42, 10.91it/s]  3%|‚ñé         | 213/7220 [00:21<10:21, 11.27it/s]  3%|‚ñé         | 215/7220 [00:21<10:47, 10.82it/s]  3%|‚ñé         | 217/7220 [00:21<11:24, 10.22it/s]  3%|‚ñé         | 219/7220 [00:22<11:18, 10.31it/s]  3%|‚ñé         | 221/7220 [00:22<11:01, 10.58it/s]  3%|‚ñé         | 223/7220 [00:22<11:03, 10.54it/s]  3%|‚ñé         | 225/7220 [00:22<11:05, 10.51it/s]  3%|‚ñé         | 227/7220 [00:22<11:14, 10.36it/s]  3%|‚ñé         | 229/7220 [00:23<11:23, 10.23it/s]  3%|‚ñé         | 231/7220 [00:23<11:18, 10.30it/s]  3%|‚ñé         | 233/7220 [00:23<11:21, 10.24it/s]  3%|‚ñé         | 235/7220 [00:23<11:10, 10.42it/s]  3%|‚ñé         | 237/7220 [00:23<11:30, 10.11it/s]  3%|‚ñé         | 239/7220 [00:24<11:22, 10.23it/s]  3%|‚ñé         | 241/7220 [00:24<10:48, 10.77it/s]  3%|‚ñé         | 243/7220 [00:24<11:06, 10.47it/s]  3%|‚ñé         | 245/7220 [00:24<11:04, 10.50it/s]  3%|‚ñé         | 247/7220 [00:24<11:15, 10.32it/s]  3%|‚ñé         | 249/7220 [00:24<11:37,  9.99it/s]  3%|‚ñé         | 251/7220 [00:25<11:40,  9.95it/s]  4%|‚ñé         | 253/7220 [00:25<18:34,  6.25it/s]  4%|‚ñé         | 255/7220 [00:25<16:02,  7.23it/s]  4%|‚ñé         | 256/7220 [00:26<15:49,  7.34it/s]  4%|‚ñé         | 258/7220 [00:26<14:21,  8.08it/s]  4%|‚ñé         | 260/7220 [00:26<13:28,  8.61it/s]  4%|‚ñé         | 262/7220 [00:26<12:28,  9.29it/s]  4%|‚ñé         | 264/7220 [00:26<12:06,  9.57it/s]  4%|‚ñé         | 266/7220 [00:27<11:35, 10.00it/s]  4%|‚ñé         | 268/7220 [00:27<11:09, 10.38it/s]  4%|‚ñé         | 270/7220 [00:27<10:50, 10.69it/s]  4%|‚ñç         | 272/7220 [00:27<10:44, 10.78it/s]  4%|‚ñç         | 274/7220 [00:27<10:50, 10.67it/s]  4%|‚ñç         | 276/7220 [00:27<10:42, 10.80it/s]  4%|‚ñç         | 278/7220 [00:28<18:16,  6.33it/s]  4%|‚ñç         | 279/7220 [00:28<17:25,  6.64it/s]  4%|‚ñç         | 281/7220 [00:28<15:24,  7.51it/s]  4%|‚ñç         | 283/7220 [00:29<14:05,  8.21it/s]  4%|‚ñç         | 285/7220 [00:29<13:10,  8.78it/s]  4%|‚ñç         | 287/7220 [00:29<12:15,  9.42it/s]  4%|‚ñç         | 289/7220 [00:29<11:58,  9.64it/s]  4%|‚ñç         | 291/7220 [00:29<11:24, 10.13it/s]  4%|‚ñç         | 293/7220 [00:29<10:52, 10.62it/s]  4%|‚ñç         | 295/7220 [00:30<10:51, 10.63it/s]  4%|‚ñç         | 297/7220 [00:30<11:03, 10.43it/s]  4%|‚ñç         | 299/7220 [00:30<18:22,  6.28it/s]  4%|‚ñç         | 300/7220 [00:31<17:17,  6.67it/s]  4%|‚ñç         | 302/7220 [00:31<14:48,  7.78it/s]  4%|‚ñç         | 304/7220 [00:31<13:25,  8.59it/s]  4%|‚ñç         | 306/7220 [00:31<12:58,  8.89it/s]  4%|‚ñç         | 308/7220 [00:31<12:04,  9.54it/s]  4%|‚ñç         | 310/7220 [00:32<11:44,  9.80it/s]  4%|‚ñç         | 312/7220 [00:32<11:21, 10.13it/s]  4%|‚ñç         | 314/7220 [00:32<11:31,  9.99it/s]  4%|‚ñç         | 316/7220 [00:32<11:28, 10.02it/s]  4%|‚ñç         | 318/7220 [00:32<11:24, 10.08it/s]  4%|‚ñç         | 320/7220 [00:33<11:22, 10.11it/s]  4%|‚ñç         | 322/7220 [00:33<11:46,  9.76it/s]  4%|‚ñç         | 323/7220 [00:33<11:43,  9.80it/s]  5%|‚ñç         | 325/7220 [00:33<11:12, 10.25it/s]  5%|‚ñç         | 327/7220 [00:33<11:06, 10.34it/s]  5%|‚ñç         | 329/7220 [00:33<10:20, 11.11it/s]  5%|‚ñç         | 331/7220 [00:34<10:00, 11.47it/s]  5%|‚ñç         | 333/7220 [00:34<09:51, 11.64it/s]  5%|‚ñç         | 335/7220 [00:34<09:25, 12.17it/s]  5%|‚ñç         | 337/7220 [00:34<08:55, 12.86it/s]  5%|‚ñç         | 339/7220 [00:34<08:30, 13.48it/s]  5%|‚ñç         | 341/7220 [00:34<08:28, 13.54it/s]  5%|‚ñç         | 343/7220 [00:34<08:21, 13.70it/s]  5%|‚ñç         | 345/7220 [00:35<08:27, 13.56it/s]  5%|‚ñç         | 347/7220 [00:35<08:28, 13.52it/s]  5%|‚ñç         | 349/7220 [00:35<08:30, 13.47it/s]                                                    5%|‚ñç         | 350/7220 [00:35<08:29, 13.47it/s]{'loss': 0.5493, 'grad_norm': 6.843292236328125, 'learning_rate': 1.396e-05, 'epoch': 0.48}

  0%|          | 0/41 [00:00<?, ?it/s][A
 15%|‚ñà‚ñç        | 6/41 [00:00<00:00, 52.38it/s][A
 29%|‚ñà‚ñà‚ñâ       | 12/41 [00:00<00:00, 48.17it/s][A
 41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 17/41 [00:00<00:00, 47.39it/s][A
 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 22/41 [00:00<00:00, 47.57it/s][A
 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 27/41 [00:00<00:00, 45.00it/s][A
 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 32/41 [00:00<00:00, 45.38it/s][A
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 37/41 [00:00<00:00, 44.64it/s][A                                                  
                                               [A  5%|‚ñç         | 350/7220 [00:36<08:29, 13.47it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 41/41 [00:00<00:00, 44.64it/s][A
                                               [A{'eval_loss': 0.3209328353404999, 'eval_accuracy': 0.8726993865030674, 'eval_f1': 0.8726616374437403, 'eval_runtime': 0.941, 'eval_samples_per_second': 1385.825, 'eval_steps_per_second': 43.573, 'epoch': 0.48}
Traceback (most recent call last):
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/torch/serialization.py", line 967, in save
    _save(
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/torch/serialization.py", line 1268, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:858] . PytorchStreamWriter failed writing file data/1: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/dati/home/n386543/dm_project/train_sci_tail.py", line 142, in <module>
    trainer.train()
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/transformers/trainer.py", line 2325, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/transformers/trainer.py", line 2756, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/transformers/trainer.py", line 3228, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial)
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/transformers/trainer.py", line 3345, in _save_checkpoint
    self._save_optimizer_and_scheduler(output_dir)
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/transformers/trainer.py", line 3472, in _save_optimizer_and_scheduler
    torch.save(self.optimizer.state_dict(), os.path.join(output_dir, OPTIMIZER_NAME))
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/torch/serialization.py", line 966, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/dati/home/n386543/dm_project/venv/lib/python3.11/site-packages/torch/serialization.py", line 798, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:664] . unexpected pos 55168 vs 55060
  5%|‚ñç         | 350/7220 [00:38<12:37,  9.07it/s]
